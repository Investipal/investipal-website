---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import PageHeroSection from '../components/sections/PageHeroSection.astro';
import Breadcrumb from '../components/ui/Breadcrumb.astro';
import StandardButton from '../components/ui/StandardButton.astro';
import StandardIcon from '../components/ui/StandardIcon.astro';
import StandardBadge from '../components/ui/StandardBadge.astro';
import { workflowData } from '../data/workflowData';
import CTASection from '../components/sections/CTASection.astro';
import TestimonialAuthor from '../components/ui/TestimonialAuthor.astro';
import CookieBanner from '../components/ui/CookieBanner.astro';
import { designSystem } from '../data/designSystem';

// SEO Metadata
const title = "How Investipal Works | AI Proposal Generator & Portfolio Software for Advisors";
const description = "See how financial advisors use Investipal to onboard clients in days, generate proposals in 10 minutes, and automate compliance. Replace 6+ tools with one platform.";
const canonical = "https://investipal.co/how-it-works";
const keywords = "financial advisor software, investment proposal software, AI automation, portfolio management, alternatives portfolio management, goal-based portfolio construction, client onboarding, proposal generation, compliance automation, IPS generator, Reg BI automation, RIA software, wealth management platform";

// Page data
const pageData = {
  hero: {
    title: "From Prospect to Portfolio in One Seamless Workflow",
    subtitle: "See how financial advisors use Investipal to close deals 3x faster, automate compliance, and manage portfolios across all asset classes—without juggling 6+ tools.",
    audienceText: "Workflow Guide"
  }
};

// Generate breadcrumb items
const breadcrumbItems = [
  { name: 'Home', href: '/' },
  { name: 'How It Works', href: '/how-it-works' }
];

// Structured Data for SEO
const structuredData = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": title,
  "description": description,
  "url": canonical,
  "mainEntity": {
    "@type": "HowTo",
    "name": "How Investipal Works for Financial Advisors",
    "description": "Complete workflow automation for financial advisors using AI-powered tools",
    "step": workflowData.map((step, index) => ({
      "@type": "HowToStep",
      "position": index + 1,
      "name": step.title,
      "text": step.description
    }))
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": breadcrumbItems.map((item, index) => ({
      "@type": "ListItem",
      "position": index + 1,
      "name": item.name,
      ...(item.href && { "item": new URL(item.href, 'https://investipal.co').toString() })
    }))
  }
};

const platformModules = [
  {
    id: "marketing",
    title: "Lead Nurturing & Portfolio Monitoring",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>`,
    description: "Monitor prospect portfolios in real-time and re-engage with data-backed insights when performance dips or fees spike.",
    image: "/images/product_screenshots/crm_leads_pipeline_v1_2025-11-14.png",
    imageAlt: "CRM leads pipeline showing prospect tracking and portfolio monitoring",
    narrativeFeatures: [
      {
        title: "Capture Leads with Embeddable Risk Assessment",
        description: "Add our 3-factor risk questionnaire to your website to capture qualified leads and get instant insights into their risk tolerance.",
        link: null
      },
      {
        title: "Monitor Portfolios in Real-Time",
        description: "Track prospect and client portfolios automatically. Get alerts when portfolios underperform or drift—giving you the perfect reason to reach out.",
        link: null
      },
      {
        title: "Re-Engage with Fresh Analysis",
        description: "Generate updated portfolio comparisons and proposals on-demand. Every touchpoint is backed by current data and actionable recommendations.",
        link: "/features/ai-driven-engagement"
      }
    ],
    ctaText: "Learn More About Lead Nurturing",
    ctaLink: "/features/ai-driven-engagement"
  },
  {
    id: "sales",
    title: "Sales & Proposal Generation",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>`,
    description: "Generate professional, branded investment proposals in under 10 minutes with AI-powered content and automatic portfolio analysis charts.",
    image: "/images/product_screenshots/proposal_cover_page_v3_2025-11-14.png",
    imageAlt: "Professional branded investment proposal with custom branding and portfolio analysis",
    narrativeFeatures: [
      {
        title: "AI-Powered Portfolio Analysis",
        description: "Upload any brokerage statement and our AI extracts holdings in seconds. Run portfolio comparison, historical backtesting, or Monte Carlo simulations.",
        link: "/features/automated-statement-scanner"
      },
      {
        title: "AI Writes Your Proposals",
        description: "Let AI generate compelling narratives explaining why your strategy is superior. Customize the prompts to match your voice or let AI handle it entirely.",
        link: "/features/client-acquisition"
      },
      {
        title: "Fully Branded & Compliant",
        description: "Every proposal includes your logo, colors, and custom cover images. Add IPS and Reg BI documentation with one click—complete proposals in under 10 minutes.",
        link: "/features/investment-policy-statements"
      }
    ],
    ctaText: "Explore Proposal Features",
    ctaLink: "/features/client-acquisition"
  },
  {
    id: "onboarding",
    title: "Client Onboarding",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>`,
    description: "Send prospects one secure link to complete everything: risk assessment, statement upload, AML verification, disclosures, and advisory agreement signing.",
    image: "/images/product_screenshots/client_onboarding_portal_v3_2025-11-11.png",
    imageAlt: "Client onboarding portal with branded interface and complete workflow",
    narrativeFeatures: [
      {
        title: "One Secure Link, Complete Onboarding",
        description: "Configure your workflow once, then send prospects one branded portal link. They complete everything on their phone or desktop—no app downloads, no confusion.",
        link: "/features/client-onboarding"
      },
      {
        title: "Built-In E-Signature",
        description: "Clients sign advisory agreements and compliance documents right in the portal. No DocuSign, no extra logins. Track signature status in real-time.",
        link: "/features/client-onboarding"
      },
      {
        title: "Automated AML Compliance",
        description: "Scan driver's licenses and cross-check with OFAC automatically. Complete AML verification in minutes and onboarding in days, not weeks.",
        link: "/features/client-onboarding"
      }
    ],
    ctaText: "See How Onboarding Works",
    ctaLink: "/features/client-onboarding"
  },
  {
    id: "compliance",
    title: "Compliance Automation",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>`,
    description: "Generate IPS and Reg BI documentation in seconds. Monitor portfolio drift and stay compliant without thinking about it.",
    image: "/images/product_screenshots/ips_generator_output_v1_2025-11-14.png",
    imageAlt: "IPS generator showing automated Investment Policy Statement creation",
    narrativeFeatures: [
      {
        title: "One-Click IPS Generation",
        description: "Create personalized Investment Policy Statements in seconds. Our AI analyzes the client's goals, risk tolerance, and portfolio to generate a comprehensive IPS that's ready to sign.",
        link: "/features/investment-policy-statements"
      },
      {
        title: "Automated Reg BI Documentation",
        description: "Generate Regulation Best Interest documentation automatically. The AI explains why your recommendation is in the client's best interest and compares alternatives—everything is audit-ready.",
        link: "/features/regulation-best-interest-generator"
      },
      {
        title: "Portfolio Drift Monitoring",
        description: "Monitor all client portfolios 24/7 for drift and compliance issues. Get automated alerts and rebalancing recommendations when portfolios need attention.",
        link: "/features/risk-management"
      }
    ],
    ctaText: "Explore Compliance Features",
    ctaLink: "/features/investment-policy-statements"
  },
  {
    id: "portfolios",
    title: "Portfolio Construction & Management",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>`,
    description: "Build personalized portfolios across all asset classes—equities, fixed income, alternatives, and annuities—with AI-powered optimization.",
    image: "/images/product_screenshots/portfolio_comparison_results_v1_2025-11-14.png",
    imageAlt: "Portfolio comparison showing current vs recommended portfolios with performance analysis",
    narrativeFeatures: [
      {
        title: "Goal-Based Portfolio Construction",
        description: "Match client spending needs to optimal allocations. Input their spending sequence and our AI generates a custom portfolio that balances liquid and growth assets.",
        link: "/features/goal-based-portfolio-construction"
      },
      {
        title: "Multi-Asset Portfolio Management",
        description: "Build portfolios with equities, fixed income, alternatives, and annuities. Access our database of private securities or model custom alternatives with our security builder.",
        link: "/features/alternatives-portfolio-management"
      },
      {
        title: "AI-Powered Optimization",
        description: "Let AI optimize portfolios for risk-adjusted returns or goal-funding. Get drift alerts and rebalancing recommendations automatically across all asset classes.",
        link: "/features/asset-allocation"
      }
    ],
    ctaText: "See Portfolio Features",
    ctaLink: "/features/asset-allocation"
  }
];

const resultsData = {
  timeSaved: [
    { metric: "Seconds", description: "to extract holdings from statements with AI" },
    { metric: "10 minutes", description: "average time to complete a full proposal" },
    { metric: "3x faster", description: "close rates vs. generic presentations" }
  ],
  costSavings: "70%",
  onboardingTime: {
    before: "Weeks",
    after: "Days"
  },
  consolidatedTools: ["Nitrogen", "YCharts", "Morningstar", "Kwanti", "Orion", "Stratifi"]
};
---

<Layout 
  title={title}
  description={description}
  canonical={canonical}
  keywords={keywords}
>
  <!-- Structured Data -->
  <script type="application/ld+json" set:html={JSON.stringify(structuredData)} />
  
  <Header />
  
  <!-- Breadcrumb -->
  <Breadcrumb items={breadcrumbItems} />

  <main id="main">
    <!-- Hero Section -->
    <PageHeroSection 
      title={pageData.hero.title}
      subtitle={pageData.hero.subtitle}
      audienceText={pageData.hero.audienceText}
    >
      <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
        <StandardButton size="large">Schedule a Demo</StandardButton>
        <a href="#workflow" class={`${designSystem.links.primary} font-semibold`}>
          See the 4-Step Process ↓
        </a>
      </div>
    </PageHeroSection>

    <!-- 4-Step Workflow Section -->
    <section id="workflow" class={`${designSystem.background.secondary} ${designSystem.spacing.section}`}>
      <div class={designSystem.spacing.container}>
        <div class="text-center mb-12 md:mb-16">
          <h2 class={`${designSystem.typography.sectionTitle} mb-4`}>
            How Investipal Works
          </h2>
          <p class={`${designSystem.typography.heroSubtitle} max-w-3xl mx-auto`}>
            Get started in minutes with our simple, streamlined workflow that transforms weeks of work into 10-minute processes.
          </p>
        </div>
        
        <div class={`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 ${designSystem.spacing.gridGap}`}>
          {workflowData.map((step, index) => (
            <div class="text-center group">
              <div class="mb-6">
                <!-- Step number badge -->
                <div class={designSystem.components.iconContainer}>
                  <span class="text-xl font-bold text-investipal-600">{index + 1}</span>
                </div>
              </div>
              
              <div class={designSystem.spacing.contentGap}>
                <h3 class={designSystem.typography.featureTitle}>
                  {step.title}
                </h3>
                <p class={designSystem.typography.body}>
                  {step.description}
                </p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Platform Modules Deep Dive -->
    <section class={designSystem.spacing.section}>
      <div class={designSystem.spacing.container}>
        <div class="text-center mb-12 md:mb-16">
          <h2 class={`${designSystem.typography.sectionTitle} mb-4`}>
            The Complete Advisory Operating System
          </h2>
          <p class={`${designSystem.typography.heroSubtitle} max-w-3xl mx-auto`}>
            Five integrated modules that cover your entire client journey from lead generation to ongoing portfolio management.
          </p>
        </div>

        <div class={designSystem.spacing.contentGapLarge}>
          {platformModules.map((module, index) => (
            <div class={`grid lg:grid-cols-2 ${designSystem.spacing.gridGap} items-center ${index % 2 === 1 ? 'lg:grid-flow-col-dense' : ''}`}>
              <div class={index % 2 === 1 ? 'lg:col-start-2' : ''}>
                <div class="flex items-center mb-6">
                  <div class={`${designSystem.components.iconContainer} mr-4`}>
                    <svg class="w-5 h-5 text-investipal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" set:html={module.icon}>
                    </svg>
                  </div>
                  <h3 class={designSystem.typography.subsectionTitle}>
                    {module.title}
                  </h3>
                </div>
                
                <p class={`${designSystem.typography.bodyLarge} mb-8`}>
                  {module.description}
                </p>
                
                <div class="space-y-6 mb-8">
                  {module.narrativeFeatures.map((feature) => (
                    <div>
                      <h4 class="text-lg font-semibold text-gray-900 mb-2 font-system_ui">
                        {feature.title}
                      </h4>
                      <p class={`${designSystem.typography.body} mb-2`}>
                        {feature.description}
                      </p>
                      {feature.link && (
                        <a 
                          href={feature.link} 
                          class="inline-flex items-center text-investipal-600 hover:text-investipal-700 font-medium text-sm transition-colors"
                        >
                          Learn more
                          <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                          </svg>
                        </a>
                      )}
                    </div>
                  ))}
                </div>
                
                {module.ctaLink && (
                  <a 
                    href={module.ctaLink}
                    class="inline-flex items-center px-6 py-3 bg-investipal-600 text-white font-semibold rounded-lg hover:bg-investipal-700 transition-colors font-system_ui"
                  >
                    {module.ctaText}
                    <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                  </a>
                )}
              </div>
              
              <div class={`${index % 2 === 1 ? 'lg:col-start-1' : ''} ${index % 2 === 1 ? 'lg:row-start-1' : ''}`}>
                {module.image ? (
                  <div class="relative">
                    <img 
                      src={module.image} 
                      alt={module.imageAlt || module.title} 
                      class="w-full rounded-2xl shadow-2xl border border-gray-200/50"
                      loading="lazy"
                      decoding="async"
                    />
                  </div>
                ) : (
                  <div class="bg-gradient-to-br from-violet-50 to-violet-100 rounded-2xl p-8 lg:p-12">
                    <div class="text-center">
                      <div class="inline-flex items-center justify-center w-24 h-24 bg-white rounded-full shadow-lg mb-6">
                        <div class="text-violet-600">
                          <Fragment set:html={module.icon} />
                        </div>
                      </div>
                      <p class="text-gray-600 font-system_ui">
                        Interactive demo placeholder for {module.title}
                      </p>
                    </div>
                  </div>
                )}
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Results & ROI Section -->
    <section class={`bg-gray-900 ${designSystem.spacing.section}`}>
      <div class={designSystem.spacing.container}>
        <div class="text-center mb-12 md:mb-16">
          <h2 class={`${designSystem.typography.sectionTitle} ${designSystem.text.inverse} mb-4`}>
            Real Results for Real Advisors
          </h2>
          <p class={`${designSystem.typography.heroSubtitle} text-gray-300 max-w-3xl mx-auto`}>
            See the measurable impact Investipal has on advisory practices across North America.
          </p>
        </div>

        <!-- Time Savings -->
        <div class="grid md:grid-cols-3 gap-8 mb-16">
          {resultsData.timeSaved.map((item) => (
            <div class="text-center bg-gray-800 rounded-xl p-8">
              <div class="text-4xl md:text-5xl font-bold text-violet-400 font-system_ui mb-2">
                {item.metric}
              </div>
              <p class="text-gray-300 font-system_ui">
                {item.description}
              </p>
            </div>
          ))}
        </div>

        <!-- Key Metrics -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
          <div class="text-center bg-gray-800 rounded-xl p-8">
            <div class="text-5xl md:text-6xl font-bold text-green-400 font-system_ui mb-2">
              {resultsData.costSavings}
            </div>
            <p class="text-gray-300 font-system_ui">
              Cost savings vs. common tech stack
            </p>
          </div>
          
          <div class="text-center bg-gray-800 rounded-xl p-8">
            <div class="text-2xl md:text-3xl font-bold text-blue-400 font-system_ui mb-2">
              {resultsData.onboardingTime.before} → {resultsData.onboardingTime.after}
            </div>
            <p class="text-gray-300 font-system_ui">
              Client onboarding time reduction
            </p>
          </div>
          
          <div class="text-center bg-gray-800 rounded-xl p-8 md:col-span-2 lg:col-span-1">
            <div class="text-4xl md:text-5xl font-bold text-orange-400 font-system_ui mb-2">
              95%
            </div>
            <p class="text-gray-300 font-system_ui">
              Time saved on manual processes
            </p>
          </div>
        </div>

        <!-- Consolidated Tools -->
        <div class="text-center">
          <h3 class="text-2xl md:text-3xl font-bold text-white font-system_ui mb-6">
            Replace Your Fragmented Tech Stack
          </h3>
          <p class="text-gray-300 font-system_ui mb-8">
            Firms have consolidated away from these tools:
          </p>
          <div class="flex flex-wrap justify-center gap-4">
            {resultsData.consolidatedTools.map((tool) => (
              <span class="bg-gray-800 text-gray-300 px-4 py-2 rounded-lg font-system_ui">
                {tool}
              </span>
            ))}
          </div>
        </div>
      </div>
    </section>

    <!-- Testimonials Section -->
    <section class={`${designSystem.background.primary} ${designSystem.spacing.section}`}>
      <div class={designSystem.spacing.container}>
        <div class="text-center mb-12">
          <h2 class={`${designSystem.typography.sectionTitle} mb-4`}>
            What Advisors Are Saying
          </h2>
        </div>

        <div class={`grid lg:grid-cols-2 ${designSystem.spacing.gridGap}`}>
          <!-- Testimonial 1 -->
          <div class={`${designSystem.background.secondary} rounded-xl p-8`}>
            <blockquote class={`${designSystem.typography.bodyLarge} mb-6`}>
              "Investipal has been a game-changer for our firm. It really had become an efficiency multiplier for our assistants and back office. The streamlined data gathering and compliance processes have freed up our time, allowing us to focus on what truly matters—our clients."
            </blockquote>
            <TestimonialAuthor 
              name="Matthew Sweeney"
              title="Managing Partner at WJCM Inc."
              imageSrc="/images/team_photos/matthew-sweeney.jpg"
              size="md"
            />
          </div>

          <!-- Testimonial 2 -->
          <div class={`${designSystem.background.secondary} rounded-xl p-8`}>
            <blockquote class={`${designSystem.typography.bodyLarge} mb-6`}>
              "At ProsperPlan Wealth, we're deeply committed to integrating cutting-edge technology to transform the financial planning landscape. Investipal's innovative approach aligns perfectly with our vision, particularly in utilizing OCR technology to streamline processes."
            </blockquote>
            <TestimonialAuthor 
              name="Lauren M. Williams"
              title="CEO, ProsperPlan Wealth"
              imageSrc="/images/external/66cf4f1cdec6f9fb4a1d4554_40cb0baa-70cc-4eef-9326-255691abafee.png"
              size="md"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <CTASection />
  </main>

  <Footer />
  <CookieBanner />
</Layout>


